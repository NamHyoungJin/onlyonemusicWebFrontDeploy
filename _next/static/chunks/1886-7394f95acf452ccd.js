"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1886],{25784:(e,s,t)=>{t.d(s,{A:()=>n});var r=t(23464);let a=()=>{let e="https://api.onlyonemusic.com/api";return e?e.endsWith("/api")?e:"".concat(e,"/api"):"http://localhost:8000/api"},o=r.A.create({baseURL:a(),withCredentials:!0});o.interceptors.request.use(e=>{{let s=localStorage.getItem("access_token");s&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(s))}return e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{let s=e.config;if(e.response&&401===e.response.status&&!s._retry){s._retry=!0;try{let e,l=localStorage.getItem("refresh_token"),u="".concat(a(),"/token/refresh/"),i=await r.A.post(u,{refresh:l},{withCredentials:!0});if(i.data.onlyonemusicAPIResponse){var t,n;let s=i.data.onlyonemusicAPIResponse;"00"===s.ErrorCode&&(null==(t=s.Result)?void 0:t.access)?e=s.Result.access:console.error("❌ [axios.ts] 새로운 포맷 조건 불만족 - ErrorCode:",s.ErrorCode,"Result.access 존재:",!!(null==(n=s.Result)?void 0:n.access))}else i.data.access?e=i.data.access:console.error("❌ [axios.ts] 지원되지 않는 응답 포맷:",i.data);return e&&"string"==typeof e&&e.trim().length>0?localStorage.setItem("access_token",e):(console.error("❌ [axios.ts] 유효하지 않은 access_token:",e),console.error("❌ [axios.ts] 토큰 갱신 실패 - undefined 또는 빈 값")),e&&"string"==typeof e&&e.trim().length>0&&(s.headers=s.headers||{},s.headers.Authorization="Bearer ".concat(e)),o(s)}catch(e){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/membership/login",Promise.reject(e)}}return Promise.reject(e)});let n=o},31886:(e,s,t)=>{t.d(s,{Lx:()=>o,Md:()=>m,R4:()=>y,RE:()=>v,TK:()=>c,TX:()=>l,dF:()=>n,dX:()=>a,hG:()=>p,hU:()=>i,w2:()=>h,y4:()=>d});var r=t(25784);let a=async e=>{try{let s=await r.A.post("/membership/register/",e);return{data:s.data,status:s.status}}catch(e){var s,t,a;return console.error("API 호출 오류:",e),{error:(null==(t=e.response)||null==(s=t.data)?void 0:s.message)||"회원가입에 실패했습니다.",status:(null==(a=e.response)?void 0:a.status)||500}}},o=async e=>{try{let s=await r.A.post("/membership/login/",e);return{data:s.data,status:s.status}}catch(e){var s,t,a,o,n,l,u;if(null==(t=e.response)||null==(s=t.data)?void 0:s.onlyonemusicAPIResponse)return{error:e.response.data.onlyonemusicAPIResponse.Message||"로그인에 실패했습니다.",status:(null==(u=e.response)?void 0:u.status)||500};return{error:(null==(n=e.response)||null==(o=n.data)||null==(a=o.non_field_errors)?void 0:a[0])||"로그인에 실패했습니다.",status:(null==(l=e.response)?void 0:l.status)||500}}},n=async e=>{try{let s=await r.A.post("/membership/check-username-new/",{username:e});return{data:s.data,status:s.status}}catch(e){var s,t,a;return{error:(null==(t=e.response)||null==(s=t.data)?void 0:s.message)||"중복 확인에 실패했습니다.",status:(null==(a=e.response)?void 0:a.status)||500}}},l=async e=>{try{let s=await r.A.post("/membership/check-email-new/",{email:e});return{data:s.data,status:s.status}}catch(e){var s,t,a;return{error:(null==(t=e.response)||null==(s=t.data)?void 0:s.message)||"중복 확인에 실패했습니다.",status:(null==(a=e.response)?void 0:a.status)||500}}},u=async()=>{let e=localStorage.getItem("refresh_token");if(!e)return null;try{let a=await r.A.post("/token/refresh/",{refresh:e});if(a.data.onlyonemusicAPIResponse){var s,t;let e=a.data.onlyonemusicAPIResponse;if("00"===e.ErrorCode&&(null==(s=e.Result)?void 0:s.access)){let s=e.Result.access;if(s&&"string"==typeof s&&s.trim().length>0)return localStorage.setItem("access_token",s),s;console.error("❌ [api.ts] 새로운 포맷 유효하지 않은 access_token:",s)}else console.error("❌ [api.ts] 새로운 포맷 조건 불만족 - ErrorCode:",e.ErrorCode,"Result.access 존재:",!!(null==(t=e.Result)?void 0:t.access))}else if(a.data.access){let e=a.data.access;if(e&&"string"==typeof e&&e.trim().length>0)return localStorage.setItem("access_token",e),e;console.error("❌ [api.ts] 기존 포맷 유효하지 않은 access_token:",e)}else console.error("❌ [api.ts] 지원되지 않는 응답 포맷:",a.data);return null}catch(e){return null}},i=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=localStorage.getItem("access_token"),a={...s,headers:{...s.headers||{},Authorization:"Bearer ".concat(t)}};try{return await (0,r.A)(e,a)}catch(s){var o;if((null==(o=s.response)?void 0:o.status)===401){let s=await u();if(s)return a.headers.Authorization="Bearer ".concat(s),await (0,r.A)(e,a);localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user_info"),window.location.href="/membership/login"}throw s}},c=async e=>{if(!localStorage.getItem("access_token"))return{error:"로그인이 필요합니다.",status:401};try{let s=await i("/membership/user/update/",{method:"PATCH",data:e});return{data:s.data,status:s.status}}catch(e){var s,t,r;return{error:(null==(t=e.response)||null==(s=t.data)?void 0:s.message)||"회원정보 수정에 실패했습니다.",status:(null==(r=e.response)?void 0:r.status)||500}}},d=async()=>{if(!localStorage.getItem("access_token"))return{error:"로그인이 필요합니다.",status:401};try{let e=await i("/membership/logout/",{method:"POST"});return{data:e.data,status:e.status}}catch(r){var e,s,t;return console.error("❌ [api.ts] 로그아웃 API 호출 실패:",r),{error:(null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"로그아웃에 실패했습니다.",status:(null==(t=r.response)?void 0:t.status)||500}}},p=async()=>{if(!localStorage.getItem("access_token"))return{error:"로그인이 필요합니다.",status:401};try{let e=await i("/membership/user/delete/",{method:"DELETE"});return{data:e.data,status:e.status}}catch(r){var e,s,t;return{error:(null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"회원 탈퇴에 실패했습니다.",status:(null==(t=r.response)?void 0:t.status)||500}}},m=async e=>{var s,t,a,o,n,l,u;try{let t=await r.A.post("/membership/find-id/",e);if(null==(s=t.data)?void 0:s.onlyonemusicAPIResponse){let e=t.data.onlyonemusicAPIResponse;if("00"===e.ErrorCode)return{data:e.Result,status:t.status};return{error:e.Message||"아이디 찾기에 실패했습니다.",status:t.status}}return{data:t.data,status:t.status}}catch(e){if(null==(a=e.response)||null==(t=a.data)?void 0:t.onlyonemusicAPIResponse)return{error:e.response.data.onlyonemusicAPIResponse.Message||"아이디 찾기에 실패했습니다.",status:(null==(u=e.response)?void 0:u.status)||500};return{error:(null==(n=e.response)||null==(o=n.data)?void 0:o.message)||"아이디 찾기에 실패했습니다.",status:(null==(l=e.response)?void 0:l.status)||500}}},h=async e=>{var s,t,a,o,n,l,u;try{let t=await r.A.post("/membership/password-reset/request/",e);if(null==(s=t.data)?void 0:s.onlyonemusicAPIResponse){let e=t.data.onlyonemusicAPIResponse;if("00"===e.ErrorCode)return{data:e.Result,status:t.status};return{error:e.Message||"패스워드 재설정 요청에 실패했습니다.",status:t.status}}return{data:t.data,status:t.status}}catch(e){if(null==(a=e.response)||null==(t=a.data)?void 0:t.onlyonemusicAPIResponse)return{error:e.response.data.onlyonemusicAPIResponse.Message||"패스워드 재설정 요청에 실패했습니다.",status:(null==(u=e.response)?void 0:u.status)||500};return{error:(null==(n=e.response)||null==(o=n.data)?void 0:o.message)||"패스워드 재설정 요청에 실패했습니다.",status:(null==(l=e.response)?void 0:l.status)||500}}},v=async e=>{var s,t,a,o,n,l,u;try{let t=await r.A.post("/membership/password-reset/verify/",e);if(null==(s=t.data)?void 0:s.onlyonemusicAPIResponse){let e=t.data.onlyonemusicAPIResponse;if("00"===e.ErrorCode)return{data:e.Result,status:t.status};return{error:e.Message||"인증코드 확인에 실패했습니다.",status:t.status}}return{data:t.data,status:t.status}}catch(e){if(null==(a=e.response)||null==(t=a.data)?void 0:t.onlyonemusicAPIResponse)return{error:e.response.data.onlyonemusicAPIResponse.Message||"인증코드 확인에 실패했습니다.",status:(null==(u=e.response)?void 0:u.status)||500};return{error:(null==(n=e.response)||null==(o=n.data)?void 0:o.message)||"인증코드 확인에 실패했습니다.",status:(null==(l=e.response)?void 0:l.status)||500}}},y=async e=>{var s,t,a,o,n,l,u;try{let t=await r.A.post("/membership/password-reset/confirm/",e);if(null==(s=t.data)?void 0:s.onlyonemusicAPIResponse){let e=t.data.onlyonemusicAPIResponse;if("00"===e.ErrorCode)return{data:e.Result,status:t.status};return{error:e.Message||"패스워드 변경에 실패했습니다.",status:t.status}}return{data:t.data,status:t.status}}catch(e){if(null==(a=e.response)||null==(t=a.data)?void 0:t.onlyonemusicAPIResponse)return{error:e.response.data.onlyonemusicAPIResponse.Message||"패스워드 변경에 실패했습니다.",status:(null==(u=e.response)?void 0:u.status)||500};return{error:(null==(n=e.response)||null==(o=n.data)?void 0:o.message)||"패스워드 변경에 실패했습니다.",status:(null==(l=e.response)?void 0:l.status)||500}}}}}]);