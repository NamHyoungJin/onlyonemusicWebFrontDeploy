(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4913],{25784:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(23464);let l=()=>{let e="https://api.onlyonemusic.com/api";return e?e.endsWith("/api")?e:"".concat(e,"/api"):"http://localhost:8000/api"},r=a.A.create({baseURL:l(),withCredentials:!0});r.interceptors.request.use(e=>{{let s=localStorage.getItem("access_token");s&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(s))}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>{let s=e.config;if(e.response&&401===e.response.status&&!s._retry){s._retry=!0;try{let e,c=localStorage.getItem("refresh_token"),i="".concat(l(),"/token/refresh/"),o=await a.A.post(i,{refresh:c},{withCredentials:!0});if(o.data.onlyonemusicAPIResponse){var t,n;let s=o.data.onlyonemusicAPIResponse;"00"===s.ErrorCode&&(null==(t=s.Result)?void 0:t.access)?e=s.Result.access:console.error("❌ [axios.ts] 새로운 포맷 조건 불만족 - ErrorCode:",s.ErrorCode,"Result.access 존재:",!!(null==(n=s.Result)?void 0:n.access))}else o.data.access?e=o.data.access:console.error("❌ [axios.ts] 지원되지 않는 응답 포맷:",o.data);return e&&"string"==typeof e&&e.trim().length>0?localStorage.setItem("access_token",e):(console.error("❌ [axios.ts] 유효하지 않은 access_token:",e),console.error("❌ [axios.ts] 토큰 갱신 실패 - undefined 또는 빈 값")),e&&"string"==typeof e&&e.trim().length>0&&(s.headers=s.headers||{},s.headers.Authorization="Bearer ".concat(e)),r(s)}catch(e){return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/membership/login",Promise.reject(e)}}return Promise.reject(e)});let n=r},38459:(e,s,t)=>{Promise.resolve().then(t.bind(t,99814))},99814:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(95155),l=t(12115),r=t(35695);function n(e){let{licenseSid:s}=e;return(0,a.jsxs)("div",{className:"relative w-full mt-8 mb-10 rounded-xl overflow-hidden",style:{height:200},children:[(0,a.jsx)("img",{src:"/pageTitleImage03.png",alt:"사용승인(허락) 상세",className:"absolute inset-0 w-full h-full object-cover",style:{zIndex:1}}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-row items-center justify-between px-8 py-6 w-full h-full",style:{zIndex:2},children:[(0,a.jsx)("h1",{className:"text-white text-3xl md:text-4xl font-bold drop-shadow-lg text-left",children:"사용승인(허락) 상세"}),(0,a.jsxs)("div",{className:"bg-white/80 rounded-lg p-4 flex flex-col items-start max-w-[500px] min-w-[320px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("span",{className:"text-sky-500 text-xl mr-2",children:"ⓘ"}),(0,a.jsx)("span",{className:"font-bold text-base",children:"사용승인(허락) 상세"})]}),(0,a.jsxs)("div",{className:"text-gray-700 text-xs leading-relaxed",children:["신청코드: ",s,(0,a.jsx)("br",{}),"온리원 뮤직은 저작권 대리중개회사로 당사가 관리하는 음악저작물의 합법적인 이용을 위해 이용자들이 편리하게 이용할 수 있도록 최선을 다하고 있습니다.",(0,a.jsx)("br",{}),"저희 회사가 관리하는 저작물에 대해 이용하는 방법을 안내합니다.",(0,a.jsx)("br",{}),"저희 저작물은 저작물의 이용방법에 따라 권리자인 저작권자(작사가, 작곡가 등)의 이용허락이 필요합니다."]})]})]})]})}var c=t(54416),i=t(57434),o=t(13052),d=t(32650),x=t(5040),m=t(81586),h=t(81191);function u(e){let{currentStatus:s=""}=e,t="SYS19719B002"===s?"REJECTED":({SYS16112B002:1,SYS16112B003:1,SYS21323B001:2,SYS16112B004:3,SYS16112B005:4,SYS16112B006:5,SYS19719B001:5,"승인신청서 접수":1,"승인 진행 중":2,"저작료 확인 및 청구서 확인":3,"사용료 입금 요청":4,"승인서 및 계산서확인":5})[s]||1;if("REJECTED"===t)return(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("div",{className:"bg-red-50 rounded-lg p-6 border border-red-200",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-red-500 rounded-full flex items-center justify-center mb-4 shadow-md",children:(0,a.jsx)(c.A,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("span",{className:"text-red-600 text-lg font-medium text-center",children:"승인 불가"}),(0,a.jsx)("span",{className:"text-red-500 text-sm text-center mt-2",children:"해당 라이선스는 승인되지 않았습니다."})]})})});let l=e=>e<t||e===t?{circle:"w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center mb-2 shadow-md",icon:"w-10 h-10 text-white",text:"text-orange-600 text-sm font-medium text-center"}:{circle:"w-20 h-20 border-2 border-orange-300 rounded-full flex items-center justify-center mb-2 bg-white shadow-sm",icon:"w-10 h-10 text-orange-400",text:"text-orange-500 text-sm text-center"};return(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)("div",{className:"bg-orange-50 rounded-lg p-6 border border-orange-200",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:l(1).circle,children:(0,a.jsx)(i.A,{className:l(1).icon})}),(0,a.jsx)("span",{className:l(1).text,children:"승인신청서 접수"})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center mt-10",children:(0,a.jsx)(o.A,{className:"w-6 h-6 text-orange-400"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:l(2).circle,children:(0,a.jsx)(d.A,{className:l(2).icon})}),(0,a.jsx)("span",{className:l(2).text,children:"승인신청 진행중"})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center mt-10",children:(0,a.jsx)(o.A,{className:"w-6 h-6 text-orange-400"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:l(3).circle,children:(0,a.jsx)(x.A,{className:l(3).icon})}),(0,a.jsxs)("span",{className:l(3).text,children:["저작료 확인 및",(0,a.jsx)("br",{}),"청구서 확인"]})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center mt-10",children:(0,a.jsx)(o.A,{className:"w-6 h-6 text-orange-400"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:l(4).circle,children:(0,a.jsx)(m.A,{className:l(4).icon})}),(0,a.jsxs)("span",{className:l(4).text,children:["사용료 입금",(0,a.jsx)("br",{}),"요청"]})]}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center mt-10",children:(0,a.jsx)(o.A,{className:"w-6 h-6 text-orange-400"})}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:l(5).circle,children:(0,a.jsx)(h.A,{className:l(5).icon})}),(0,a.jsxs)("span",{className:l(5).text,children:["승인서 및",(0,a.jsx)("br",{}),"계산서확인"]})]})]})})})}var p=t(35169);function f(e){let{activeTab:s,onTabChange:t,pdfUrl:l,licenseSid:n,currentStatus:c=""}=e,o=(0,r.useRouter)(),x=[{id:"application",label:"승인 신청 내용",icon:d.A},{id:"invoice",label:"청구서",icon:i.A},{id:"approval",label:"승인서",icon:i.A}];return(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:x.map(e=>{let l=e.icon;return(0,a.jsxs)("button",{onClick:()=>t(e.id),className:"border-b-2 py-3 px-4 font-medium text-base flex items-center transition-all duration-200 rounded-t-lg ".concat(s===e.id?"border-blue-600 text-blue-600 bg-blue-50 border-b-0":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50"),children:[(0,a.jsx)(l,{className:"w-5 h-5 mr-2 ".concat(s===e.id?"text-blue-600":"text-gray-400")}),e.label]},e.id)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&"SYS19719B002"!==c&&(0,a.jsx)("button",{onClick:()=>{let e=document.createElement("a");e.href=l,e.setAttribute("download","".concat(s,"_").concat(n,".pdf")),document.body.appendChild(e),e.click(),e.remove()},className:"px-4 py-2 bg-blue-200 text-blue-800 rounded hover:bg-blue-300 transition-colors",children:"PDF 다운로드"}),(0,a.jsxs)("button",{onClick:()=>o.back(),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-700 transition-colors flex items-center",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"목록으로 돌아가기"]})]})]})})})}var j=t(55028),b=t(25784);let g=(0,j.default)(()=>Promise.all([t.e(2196),t.e(592),t.e(3570),t.e(5901)]).then(t.bind(t,27741)),{loadableGenerated:{webpack:()=>[27741]},ssr:!1});function v(e){let{activeTab:s,licenseSid:t,onPdfUrlChange:r,currentStatus:n=""}=e,[c,i]=(0,l.useState)({loading:!1,hasData:!1,error:null,pdfUrl:null}),o="SYS19719B002"===n,d=e=>{switch(e){case"application":default:return"/pdfExport/license/approval/application/".concat(t,"/");case"invoice":return"/pdfExport/license/approval/invoice/".concat(t,"/");case"approval":return"/pdfExport/license/approval/agreement/".concat(t,"/")}},x=e=>{switch(e){case"application":default:return"승인 신청 내용";case"invoice":return"청구서";case"approval":return"승인서"}},m=async e=>{var s,t,a,l,n,c,x,m,h;if(o)return void i(e=>({...e,loading:!1,hasData:!1,error:"승인 불가 상태입니다.",pdfUrl:null}));i(e=>({...e,loading:!0,hasData:!1,error:null,pdfUrl:null}));try{let t=d(e),a=await b.A.get(t,{responseType:"blob"});if((a.headers["content-type"]||"").includes("application/json")){let e=await a.data.text(),t=JSON.parse(e);if((null==(s=t.onlyonemusicAPIResponse)?void 0:s.ErrorCode)==="99")return void i(e=>({...e,loading:!1,hasData:!1,error:t.onlyonemusicAPIResponse.Message||"오류가 발생했습니다."}))}if(a.data&&a.data.size>0){let e=URL.createObjectURL(a.data);i(s=>({...s,loading:!1,hasData:!0,error:null,pdfUrl:e})),null==r||r(e)}else i(e=>({...e,loading:!1,hasData:!1,error:null}))}catch(r){console.error("API 호출 오류 (".concat(e,"):"),r);let s="데이터를 불러오는데 실패했습니다.";if((null==(t=r.response)?void 0:t.data)instanceof Blob){if((r.response.headers["content-type"]||"").includes("application/json"))try{let e=await r.response.data.text(),t=JSON.parse(e);(null==(h=t.onlyonemusicAPIResponse)?void 0:h.Message)?s=t.onlyonemusicAPIResponse.Message:t.Message&&(s=t.Message)}catch(e){console.error("JSON 파싱 오류:",e)}}else(null==(n=r.response)||null==(l=n.data)||null==(a=l.onlyonemusicAPIResponse)?void 0:a.Message)?s=r.response.data.onlyonemusicAPIResponse.Message:(null==(x=r.response)||null==(c=x.data)?void 0:c.Message)?s=r.response.data.Message:(null==(m=r.response)?void 0:m.status)===404&&(s="해당 데이터가 없습니다.");i(e=>({...e,loading:!1,hasData:!1,error:s}))}};return((0,l.useEffect)(()=>{t&&m(s)},[s,t,n]),c.loading)?(0,a.jsx)("div",{className:"min-h-[400px]",children:(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:x(s)}),(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"데이터를 불러오는 중..."})})]})}):c.error?(0,a.jsx)("div",{className:"min-h-[400px]",children:(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:x(s)}),(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-red-500 mb-4",children:c.error}),(0,a.jsx)("button",{onClick:()=>m(s),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"다시 시도"})]})]})}):c.hasData?(0,a.jsx)("div",{className:"min-h-[400px]",children:c.pdfUrl&&(0,a.jsx)("div",{className:"flex flex-col items-center",children:(0,a.jsx)(g,{fileUrl:c.pdfUrl})})}):(0,a.jsx)("div",{className:"min-h-[400px]",children:(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:x(s)}),(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("div",{className:"text-gray-500",children:"해당 데이터가 없습니다."})})]})})}function N(){let e=(0,r.useSearchParams)(),[s,t]=(0,l.useState)(null),c=e.get("licenseHistoryKind")||"",[i,o]=(0,l.useState)("application"),[d,x]=(0,l.useState)(null);return((0,l.useEffect)(()=>{t(e.get("licenseSid"))},[e]),s)?(0,a.jsxs)("div",{className:"max-w-[1200px] mx-auto px-4",children:[(0,a.jsx)(n,{licenseSid:s}),(0,a.jsx)(u,{currentStatus:c}),(0,a.jsx)(f,{activeTab:i,onTabChange:o,pdfUrl:d,licenseSid:s,currentStatus:c}),(0,a.jsx)(v,{activeTab:i,licenseSid:s,onPdfUrlChange:x,currentStatus:c})]}):(0,a.jsx)("div",{className:"max-w-[1200px] mx-auto px-4",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("div",{className:"text-gray-600",children:"로딩중..."})]})})})}function y(){return(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{className:"max-w-[1200px] mx-auto px-4",children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("div",{className:"text-gray-600",children:"로딩중..."})]})})}),children:(0,a.jsx)(N,{})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3464,8372,8441,1684,7358],()=>s(38459)),_N_E=e.O()}]);