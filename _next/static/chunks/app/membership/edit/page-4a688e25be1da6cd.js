(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5916],{4244:(e,a,s)=>{Promise.resolve().then(s.bind(s,12854))},12854:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(95155),r=s(12115),l=s(31886);function o(){let[e,a]=(0,r.useState)({name:"",email:"",phone:"",password:"",passwordConfirm:""}),[s,o]=(0,r.useState)(!1),[n,d]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),[u,m]=(0,r.useState)("");(0,r.useEffect)(()=>{{let e=localStorage.getItem("user_info");if(e)try{let s=JSON.parse(e);a(e=>({...e,name:s.name||"",email:s.email||"",phone:s.phone||""}))}catch(e){}}},[]);let x=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),f=s=>{a({...e,[s.target.name]:s.target.value}),"email"===s.target.name&&(x(s.target.value)?m(""):m("올바른 이메일 형식이 아닙니다."))},p=async()=>{o(!0),d(""),c(""),m("");let s={name:e.name,email:e.email,phone:e.phone};e.password&&(s.password=e.password);try{let e=await (0,l.TK)(s);if(e.data&&e.data.user){{let a=e.data.user;localStorage.setItem("user_info",JSON.stringify(a))}d("회원정보가 성공적으로 수정되었습니다."),a(e=>({...e,password:"",passwordConfirm:""}))}else e.data&&e.data.email&&Array.isArray(e.data.email)?m(e.data.email[0]):c(e.error||"회원정보 수정에 실패했습니다.")}catch(e){c("회원정보 수정 중 오류가 발생했습니다.")}finally{o(!1)}},g=async()=>{if(window.confirm("정말로 회원 탈퇴하시겠습니까?\n탈퇴 시 모든 정보가 비활성화됩니다.")){o(!0),d(""),c("");try{let e=await (0,l.hG)();e.data&&e.data.message?(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user_info"),alert("회원 탈퇴가 완료되었습니다."),window.location.href="/"):c(e.error||"회원 탈퇴에 실패했습니다.")}catch(e){c("회원 탈퇴 중 오류가 발생했습니다.")}finally{o(!1)}}};return(0,t.jsx)("div",{className:"min-h-[55vh] flex items-center justify-center bg-[#fafbfc] px-4 mb-60",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-12 w-full max-w-5xl",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-10 w-full max-w-md flex flex-col items-center",children:[(0,t.jsx)("img",{src:"/logo_dark.png",alt:"ONLY ONE MUSIC",className:"w-56 mb-8"}),(0,t.jsxs)("form",{className:"w-full flex flex-col gap-4",children:[(0,t.jsx)("input",{type:"text",name:"name",value:e.name,onChange:f,placeholder:"이름",className:"border-2 border-black rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,t.jsx)("input",{type:"email",name:"email",value:e.email,onChange:f,placeholder:"이메일",className:"border border-gray-300 rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400"}),u&&(0,t.jsx)("div",{className:"text-red-500 text-xs mt-1",children:u}),(0,t.jsx)("input",{type:"text",name:"phone",value:e.phone,onChange:f,placeholder:"휴대폰 번호",className:"border border-gray-300 rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,t.jsx)("hr",{className:"my-2"}),(0,t.jsx)("input",{type:"password",name:"password",value:e.password,onChange:f,placeholder:"새 비밀번호 (선택)",className:"border border-gray-300 rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,t.jsx)("input",{type:"password",name:"passwordConfirm",value:e.passwordConfirm,onChange:f,placeholder:"새 비밀번호 확인 (선택)",className:"border border-gray-300 rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,t.jsx)("button",{type:"button",onClick:p,disabled:s||!!u,className:"bg-[#1CA9E3] text-white py-3 rounded-md font-semibold text-lg hover:bg-[#189fd1] transition-colors mt-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"수정 중...":"회원정보 수정"}),n&&(0,t.jsx)("div",{className:"text-green-600 text-sm mt-2",children:n}),i&&(0,t.jsx)("div",{className:"text-red-500 text-sm mt-2",children:i}),(0,t.jsx)("button",{type:"button",onClick:g,disabled:s,className:"bg-white border border-red-400 text-red-500 py-3 rounded-md font-semibold text-lg hover:bg-red-50 transition-colors mt-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"회원 탈퇴"})]})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-gray-700 text-base",children:[(0,t.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD12"}),"회원정보를 안전하게 관리하세요."]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-gray-700 text-base",children:[(0,t.jsx)("span",{className:"text-2xl",children:"✏️"}),"비밀번호 변경은 선택사항입니다."]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-gray-700 text-base",children:[(0,t.jsx)("span",{className:"text-2xl",children:"❌"}),"회원 탈퇴 시 모든 정보가 삭제됩니다."]})]})]})})}function n(e){let{userId:a,onVerified:s}=e,[o,n]=(0,r.useState)(""),[d,i]=(0,r.useState)(!1),[c,u]=(0,r.useState)(""),m=async e=>{e.preventDefault(),i(!0),u("");try{var t,r,n;let e=await (0,l.Lx)({username:a,password:o});if((null==(r=e.data)||null==(t=r.onlyonemusicAPIResponse)?void 0:t.ErrorCode)==="00")s();else{let a=null==(n=e.data)?void 0:n.onlyonemusicAPIResponse;u((null==a?void 0:a.Message)||e.error||"비밀번호가 올바르지 않습니다.")}}catch(e){console.error("비밀번호 확인 오류:",e),u("비밀번호 검증 중 오류가 발생했습니다.")}finally{i(!1)}};return(0,t.jsx)("div",{className:"min-h-[40vh] flex items-center justify-center bg-[#fafbfc] px-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-10 w-full max-w-md flex flex-col items-center",children:[(0,t.jsx)("img",{src:"/logo_dark.png",alt:"ONLY ONE MUSIC",className:"w-40 mb-6"}),(0,t.jsxs)("form",{onSubmit:m,className:"w-full flex flex-col gap-4",children:[(0,t.jsx)("input",{type:"password",name:"password",value:o,onChange:e=>n(e.target.value),placeholder:"비밀번호를 입력하세요",className:"border-2 border-black rounded-md px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-400",autoFocus:!0}),c&&(0,t.jsx)("div",{className:"text-red-500 text-sm text-center mt-1",children:c}),(0,t.jsx)("button",{type:"submit",disabled:d||!o,className:"bg-[#1CA9E3] text-white py-3 rounded-md font-semibold text-lg hover:bg-[#189fd1] transition-colors disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:d?"확인 중...":"확인"})]})]})})}var d=s(35695);function i(){let[e,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(""),i=(0,d.useRouter)();return((0,r.useEffect)(()=>{{let e=localStorage.getItem("user_info"),a=localStorage.getItem("access_token");if(!e||!a)return void i.push("/membership/login");try{let a=JSON.parse(e);l(a.username||"")}catch(e){console.error("사용자 정보 파싱 오류:",e),i.push("/membership/login")}}},[i]),s)?e?(0,t.jsx)(o,{}):(0,t.jsx)(n,{userId:s,onVerified:()=>a(!0)}):null}},35695:(e,a,s)=>{"use strict";var t=s(18999);s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(a,{useSearchParams:function(){return t.useSearchParams}})}},e=>{var a=a=>e(e.s=a);e.O(0,[3464,1886,8441,1684,7358],()=>a(4244)),_N_E=e.O()}]);